<!doctype html>
<!--
Copyright 2016 Google Inc.

Use of this source code is governed by a MIT-style license that can be found in
the LICENSE file or at https://opensource.org/licenses/MIT.
-->
<html>
  <head>
    <title>Microformats</title>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-browser/0.1.0/jquery.browser.js"></script>
    <style>
        h1 {
          font-size: 1.25em;
        }
        form {
          margin: 1em 0;
        }
        input[type=url] {
          width: 30em;
        }
        #results > section {
          background: #f7f7f7;
          float: left;
          width: calc(25% - 2em - 10px);
          overflow: auto;
          margin: 0 5px;
          padding: 1em;
        }
        #results > section > h2 {
          font-size: 1.125em;
          margin: 0;
          padding: 0;
        }
    </style>
  </head>
  <body>
    <h1>mf2compare</h1>
    <p>Compare the results of different microformats2 libraries.</p>
    <form action="" method="get">
      <input type="url" name="url" id="url" placeholder="URL" autofocus>
      <input type="submit" value="Parse Microformats">
    </form>

    <div id="results">
    </div>

    <script>
      var services = [
        {
          name: "microformat-node",
          endpoint: "http://glennjones.net/tools/microformats/",
        },
        {
          name: "php-mf2",
          endpoint: "https://pin13.net/mf2/",
        },
        {
          name: "mf2py",
          endpoint: "https://mf2.kylewm.com/",
        },
        {
          name: "gomf",
          endpoint: "https://willnorris.com/go/microformats/live",
        },
      ];

      var url = new URL(window.location).searchParams.get("url");
      if (url) {
        document.getElementById("url").value = url
        services.forEach(function(service) {
          console.log("calling:", service.endpoint);
          jQuery.ajax(service.endpoint, {
            data: {'url':url},
            dataType: 'jsonp',
            cache: true,
            success: function(data) {
              delete data.debug; // remove debug info added by php-mf2
              var result = $('<section></section>');
              $('<h2><a href="'+service.endpoint+'">'+service.name+'</a></h2>').appendTo(result);
              result.append($('<pre></pre>').text(JSON.stringify(data, null, 2)));
              result.appendTo('#results');
            },
          });
        });
      }
    </script>
  </body>
</html>
